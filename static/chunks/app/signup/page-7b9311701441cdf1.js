(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{1892:function(a,e,t){Promise.resolve().then(t.bind(t,4992))},8792:function(a,e,t){"use strict";t.d(e,{default:function(){return l.a}});var n=t(5250),l=t.n(n)},7907:function(a,e,t){"use strict";var n=t(5313);t.o(n,"redirect")&&t.d(e,{redirect:function(){return n.redirect}}),t.o(n,"useRouter")&&t.d(e,{useRouter:function(){return n.useRouter}})},449:function(a,e,t){"use strict";t.d(e,{z:function(){return l}});var n=t(7437);t(5672);let l=a=>{let{content:e,color:t,width:l,height:r,disabled:i}=a;return(0,n.jsx)("div",{className:"buttonContainer",style:{width:l||"100px",height:r||"40px",background:t||"#77DD77",cursor:i?"not-allowed":"pointer"},children:e})}},2329:function(a,e,t){"use strict";t.d(e,{k:function(){return c}});let n={PRODUCT_MAINLIST:"products/productMainList",GET_PRODUCT_BY_ID:"products/product",UPSERT_USER:"users/upsertUser",UPDATE_USER_BY_QUERY:"users/update",GET_USER_BY_EMAIL:"users/getUserByEmail",GET_IMAGES:"images/getImageNames",PRODUCT_FAMILY:"products/getAllUnderFamily",GET_ORDER_ID:"payments/createOrder",ADD_TO_BAG:"users/addToBag",GET_USER_DETAILS:"auth/getUserDetails",VERIFY_ORDER:"payments/verifyPayment"};var l=t(9079);let r={ERROR:31,INFO:32,WARN:33};function i(a,e,t){"true"!==l.env.DISABLED_LOGS&&console.log("\x1b[".concat(r[a]||33,"m%s\x1b[0m"),"[".concat(a||"INFO","] ").concat(new Date().toLocaleString()," : ").concat(t||"","=>"),JSON.stringify(e))}var o=t(1800),u=t(3810),s=t(9079);let d="http://localhost:5000/thanalApi/";async function c(a,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,h="",v="object"==typeof document;if(v){let a=window.location.href;console.log({baseUrl:d=new URL(a).origin+"/thanalApi/"}),console.log("isBrowser",v)}try{let c=d+n[e]+l,m={method:a,headers:s,body:r,next:{revalidate:null==t?void 0:t.revalidate,tags:null==t?void 0:t.tags}};if(v){let a=v?(0,u.ej)("user"):null;if(a){let e=JSON.parse(a);h=null==e?void 0:e.updatedAt}}i("INFO",{url:c,...m},"calling DB service, http options ");let p=await fetch(c,m);if(!p.ok)throw Error("Network response was not ok");let g=await p.json();if(!function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let e of a)(0,o.revalidatePath)(e);for(let a of e)(0,o.revalidateTag)(a)}(null==t?void 0:t.revalidatePaths,null==t?void 0:t.revalidateTags),i("INFO",g,"Successful response from DB service, responseData "),v){let a=v?(0,u.ej)("user"):null;if(a){let e=JSON.parse(a);h!==(null==e?void 0:e.updatedAt)&&(0,u.Is)("user")}}return g}catch(a){if(console.log("Sasi",a),i("ERROR",a,"Error on DB service call, error "),c)return c;throw a}}s.env.API_TIME_OUT},4992:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return h}});var n=t(7437),l=t(2265),r=t(449);t(241);var i=a=>{let{value:e,handleChange:t,keyName:r,dropDownValues:i,disabled:o,handleBlur:u}=a,s=0,[d,c]=(0,l.useState)(!1),[h,v]=(0,l.useState)(!0),[m,p]=(0,l.useState)(i),[g,y]=(0,l.useState)(""),f=(0,l.useRef)(null),k=a=>{y(a),setTimeout(()=>{a.length?p(i.filter(e=>e.toLowerCase().includes(a.toLowerCase()))):p(i)})},T=()=>{console.log("focus out",h,s),s&&(d||v(!0),c(!1),y(""),u(r,e)),s++},N=(a,e)=>{console.log("qwerty",a,e),t(a,e),v(!0),y("")},S={animation:"fadeIn 1s ease-in-out",maxHeight:i.length>10?"200px":"auto",width:f.current?"".concat(f.current.offsetWidth-10,"px"):"350px"},b=()=>(0,n.jsx)("div",{className:"dropDown",style:S,onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),children:m.map((a,e)=>(0,n.jsx)("div",{className:"drop",onClick:()=>{N(r,a),console.log("click")},onTouchStart:()=>{N(r,a)},children:a},e))});return i.length<10?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:f,className:"formInput",style:{cursor:o?"not-allowed":"auto",color:e?"black":"grey"},tabIndex:0,onFocus:()=>v(!1),onBlur:T,children:e||"Select one from list ..."}),h?(0,n.jsx)(n.Fragment,{}):b()]}):(0,n.jsxs)("div",{style:{width:"100%"},children:[(0,n.jsx)("input",{ref:f,className:"formInputDropDown",type:"text",value:g||(h?e||"Select one from list ...":""),onFocus:()=>{v(!1),p(i)},onChange:a=>k(a.target.value),onBlur:T,placeholder:"Search..."}),h?(0,n.jsx)(n.Fragment,{}):m.length?b():(0,n.jsx)("div",{className:"noResult drop",children:"0 results..."})]})};t(8042);let o=a=>{let{formData:e,setFormData:t,lastOne:r}=a,{label:o,key:u,value:s,message:d,required:c,invalid:h,validation:v,disabled:m,type:p,dropDownValues:g}=e,[y,f]=(0,l.useState)(!1),k=(a,e)=>{"phone pincode".includes(a)&&(e=e.replace(/[^\d]/,"")),t(t=>({...t,[a]:{...t[a],value:e}})),(h||r)&&N(a,e)},T=(a,e)=>{N(a,e),f(!0)},N=(a,e)=>{c&&!m&&(v.find(a=>!1===a(e))?t(e=>({...e,[a]:{...e[a],invalid:!0}})):t(e=>({...e,[a]:{...e[a],invalid:!1}})))};return(0,n.jsxs)("div",{className:"formControl",children:[(0,n.jsxs)("label",{className:"formlabel",onClick:()=>console.log(e,m),children:[o,c&&(0,n.jsx)("span",{style:{color:"#F08080"},children:"*"})]}),h&&y&&(0,n.jsx)("p",{className:"formInvalidMessage",children:d}),"input"===p?(0,n.jsx)("input",{className:"formInput",style:{cursor:m?"not-allowed":"auto"},type:"text",readOnly:m,value:s,onBlur:a=>T(u,a.target.value),onChange:a=>k(u,a.target.value)}):(0,n.jsx)(i,{keyName:u,value:s,handleChange:k,handleBlur:T,disabled:!!m,dropDownValues:g||[]})]})};var u=t(3810),s=t(7907);t(1429);var d=t(2329),c=t(8792),h=()=>{let a=(0,s.useRouter)(),[e,t]=(0,l.useState)(!1),[i,h]=(0,l.useState)(!1),[v,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!v){let a=(0,u.ej)("user");a&&localStorage.setItem("user",a);let e=a?JSON.parse(a):null;e?e.phone&&(0,s.redirect)("/"):(0,s.redirect)("/login"),m({name:{required:!0,label:"Name",key:"name",value:(null==e?void 0:e.name)||"",disabled:!!(null==e?void 0:e.name),type:"input",invalid:!1,validationArray:[{method:"length",value:[2,20]}],validation:[a=>a.length>2&&a.length<20],message:"Please provide valid name."},phone:{label:"Phone (+91)",key:"phone",value:"",type:"input",required:!0,invalid:!1,validationArray:[{method:"length",value:10}],validation:[a=>10===a.length],message:"Please provide valid 10 digit phone number."},email:{required:!0,label:"email",key:"email",value:(null==e?void 0:e.email)||"",disabled:!!(null==e?void 0:e.email),type:"input",invalid:!1,validationArray:[{method:"length",value:[2,20]},{method:"includes",value:"@"}],validation:[a=>a.length>2&&a.length<20&&a.includes("@")],message:"Please provide valid name."},house:{required:!0,label:"House, Building, Company",key:"house",value:"",type:"input",invalid:!1,validationArray:[{method:"length",value:[2,30]}],validation:[a=>a.length>2&&a.length<30],message:"Invalid Entry"},landmark:{type:"input",label:"Landmark",key:"landmark",value:"",required:!0,invalid:!1,validationArray:[{method:"length",value:[2,30]}],validation:[a=>a.length>2&&a.length<30],message:"Invalid Entry"},city:{type:"dropDown",dropDownValues:["Adoor","Alappuzha (Alleppey)","Aluva","Angamaly","Attingal","Calicut (Kozhikode)","Changanassery","Chavakkad","Chengannur","Cherthala","Cherthala","Cheruthuruthi","Chittur-Thathamangalam","Ernakulam","Guruvayoor","Idukki","Irinjalakuda","Kanhangad","Kannur","Kasaragod","Kayamkulam","Kochi (Cochin)","Kollam (Quilon)","Koothuparamba","Kottarakkara","Kottayam","Kozhikode (Calicut)","Kunnamkulam","Kuthuparamba","Malappuram","Mananthavady","Manjeri","Mannarkkad","Mattanur","Mavelikara","Muvattupuzha","Nedumangad","Nedumbassery","Neyyattinkara","Nilambur","North Paravur","Ottappalam","Palakkad (Palghat)","Pandalam","Pathanamthitta","Payyannur","Perinthalmanna","Perumbavoor","Ponnani","Punalur","Shoranur","Taliparamba","Thalassery","Thiruvalla","Thiruvananthapuram (Trivandrum)","Thiruvankulam","Thodupuzha","Thrissur","Tirur","Tiruvalla","Tiruvananthapuram (Trivandrum)","Tiruvannamalai","Tiruvattur","Tiruvottiyur","Vaikom","Varkala","Vatakara"],required:!0,label:"City",key:"city",value:"",disabled:!1,invalid:!1,validationArray:[{method:"dropDown"}],validation:[a=>!!(a&&["Adoor","Alappuzha (Alleppey)","Aluva","Angamaly","Attingal","Calicut (Kozhikode)","Changanassery","Chavakkad","Chengannur","Cherthala","Cherthala","Cheruthuruthi","Chittur-Thathamangalam","Ernakulam","Guruvayoor","Idukki","Irinjalakuda","Kanhangad","Kannur","Kasaragod","Kayamkulam","Kochi (Cochin)","Kollam (Quilon)","Koothuparamba","Kottarakkara","Kottayam","Kozhikode (Calicut)","Kunnamkulam","Kuthuparamba","Malappuram","Mananthavady","Manjeri","Mannarkkad","Mattanur","Mavelikara","Muvattupuzha","Nedumangad","Nedumbassery","Neyyattinkara","Nilambur","North Paravur","Ottappalam","Palakkad (Palghat)","Pandalam","Pathanamthitta","Payyannur","Perinthalmanna","Perumbavoor","Ponnani","Punalur","Shoranur","Taliparamba","Thalassery","Thiruvalla","Thiruvananthapuram (Trivandrum)","Thiruvankulam","Thodupuzha","Thrissur","Tirur","Tiruvalla","Tiruvananthapuram (Trivandrum)","Tiruvannamalai","Tiruvattur","Tiruvottiyur","Vaikom","Varkala","Vatakara"].find(e=>e===a))],message:"Invalid Entry"},state:{type:"input",label:"State",key:"state",value:"Kerala",required:!1,invalid:!1,disabled:!0,validationArray:[{method:"length",value:[2,20]}],validation:[a=>a.length>2&&a.length<20],message:"Invalid Entry"},pincode:{type:"input",required:!0,label:"Pincode",key:"pincode",value:"",invalid:!1,validationArray:[{method:"length",value:6}],validation:[a=>6===a.length],message:"Please provide valid 6 digit pincode."}})}},[]),(0,l.useEffect)(()=>{if(v){let a=Object.values(v).filter(a=>a.required&&(a.invalid||!a.value));a.length?(t(!1),1===a.length&&h(!0)):t(!0)}},[v]);let p=()=>{Object.values(v).forEach(a=>{a&&(a.required&&!a.disabled&&a.validation.find(e=>!1===e(a.value))?m(e=>({...e,[a.key]:{...e[a.key],invalid:!0}})):m(e=>({...e,[a.key]:{...e[a.key],invalid:!1}})))})},g=async t=>{if(p(),console.log("details",v),e){let e=v.email.value,t={phone:v.phone.value,address:{houseName:v.house.value,landmark:v.landmark.value,city:v.city.value,state:v.state.value,pincode:v.pincode.value}};await (0,d.k)("PUT","UPDATE_USER_BY_QUERY",{},"?email=".concat(e),JSON.stringify(t),{"Content-Type":"application/json"})&&((0,u.Is)("user"),a.push("/"))}};return(0,n.jsx)(n.Fragment,{children:v?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"loginOuterDiv",children:(0,n.jsxs)("div",{className:"loginContainer",children:[(0,n.jsxs)("div",{className:"steps",children:["Step ",2," of 2"]}),(0,n.jsx)("div",{className:"formContainer",children:(0,n.jsxs)("div",{children:[Object.values(v).map((a,e)=>(0,n.jsx)(o,{formData:a,setFormData:m,lastOne:i},e)),(0,n.jsxs)("div",{className:"formControl",children:[(0,n.jsx)("div",{onClick:g,children:(0,n.jsx)(r.z,{content:"Add Details",color:e?"":"grey",disabled:!e})}),(0,n.jsx)(c.default,{prefetch:!1,style:{cursor:"pointer",textDecoration:"none"},href:"/profile",children:(0,n.jsx)(r.z,{content:"Skip",color:"#00aaee"})})]})]})})]})})}):(0,n.jsx)(n.Fragment,{children:"Loading...."})})}},3810:function(a,e,t){"use strict";t.d(e,{Is:function(){return o},ej:function(){return l},vu:function(){return i}});var n=t(2329);function l(a){var e,t;if("object"!=typeof document||!document)return null;let n="; ".concat(null===(e=document)||void 0===e?void 0:e.cookie);console.log("&&&&&",n);let l=null==n?void 0:n.split("; ".concat(a,"="));if(2===l.length){let a=null===(t=l.pop())||void 0===t?void 0:t.split(";").shift();return a?decodeURIComponent(a):null}return null}async function r(a){return await (0,n.k)("get","GET_USER_DETAILS",{},"?email=".concat(a.email,"&updatedAt=").concat(a.updatedAt))}async function i(){let a=l("user");if(console.log("!!!!!!!!!",typeof a,{user:a}),a)return a;if("object"!=typeof document||!localStorage)return null;let e=localStorage.getItem("user");if(console.log("!!!!!!!!!",{data:e}),!e)return null;let{newData:t,loginRequired:n,cache:i}=await r(JSON.parse(e));return t?(localStorage.setItem("user",JSON.stringify(i)),JSON.stringify(i)):n?null:JSON.stringify(i)}function o(a){let e=l(a);return e?(localStorage.setItem("user",e),e):null}},5672:function(){},241:function(){},8042:function(){},1429:function(){}},function(a){a.O(0,[800,250,971,69,744],function(){return a(a.s=1892)}),_N_E=a.O()}]);